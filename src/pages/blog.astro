---
import Layout from "../layouts/Layout.astro";
import { blogTags } from "../data/blogTags";
import BlogFilter from "../components/BlogFilter.tsx";

const allPostsData = await Promise.all(
	Object.entries(import.meta.glob("./posts/*.md", { eager: true })).map(
		([path, post]) => ({
			url: path.replace("./posts/", "/posts/").replace(".md", "/"),
			id: path,
			frontmatter: (post as { frontmatter: any }).frontmatter,
		})
	)
);

const posts = allPostsData.map((post) => ({
	id: post.id,
	url: post.url,
	title: post.frontmatter.title,
	excerpt: post.frontmatter.excerpt || post.frontmatter.description || "",
	date: post.frontmatter.date
		? new Date(post.frontmatter.date).toLocaleDateString("es-ES", {
				year: "numeric",
				month: "long",
				day: "numeric",
			})
		: "Fecha no disponible",
	categories: post.frontmatter.tags || [],
	image: post.frontmatter.image || "/placeholder-image.jpg",
}));
---

<Layout>
	<div class="flex min-h-screen flex-col">
		<main class="flex-1">
			<section class="w-full bg-black py-12 md:py-16">
				<div class="container mx-auto px-4 md:px-6">
					<div
						class="flex flex-col items-center justify-center space-y-4 text-center"
					>
						<div class="space-y-2">
							<h1
								class="text-3xl mb-5 font-bold tracking-tighter text-white sm:text-5xl"
							>
								Blog
							</h1>
							<p
								class="max-w-[900px] text-gray-300 md:text-xl/relaxed lg:text-base/relaxed xl:text-xl/relaxed"
							>
								Reflexiones, tutoriales y benchmarks sobre desarrollo de
								software e inteligencia artificial
							</p>
						</div>
					</div>
				</div>
			</section>
			<BlogFilter client:load posts={posts} tags={blogTags} />
		</main>
	</div>
</Layout>
